---
import { Home, User, Menu, Pencil, Moon } from '@lucide/astro';
---

<nav class="navbar">
	<div class="nav-links">
		<a href="#home" class="nav-item active" data-section="home" aria-label="Home">
			<Home size={22} />
			<span class="nav-label">Home</span>
		</a>
		<a href="#about" class="nav-item" data-section="about" aria-label="About">
			<User size={22} />
			<span class="nav-label">About</span>
		</a>
		<a href="#services" class="nav-item" data-section="services" aria-label="Services">
			<Menu size={22} />
			<span class="nav-label">Services</span>
		</a>
		<a href="#portfolio" class="nav-item" data-section="portfolio" aria-label="Portfolio">
			<Pencil size={22} />
			<span class="nav-label">Portfolio</span>
		</a>
	</div>
	<button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode">
		<Moon size={20} />
	</button>
</nav>

<style>
	.navbar {
		position: fixed;
		left: 40px;
		top: 200px;
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 20px;
		z-index: 1000;
	}

	.nav-links {
		display: flex;
		flex-direction: column;
		align-items: center;
		gap: 8px;
		padding: 8px;
	}

	.nav-item {
		position: relative;
		display: flex;
		align-items: center;
		justify-content: center;
		width: 48px;
		height: 48px;
		border-radius: 14px;
		color: rgba(30, 41, 59, 0.4);
		text-decoration: none;
		transition: all 0.3s ease;
	}

	.nav-label {
		position: absolute;
		left: 70px;
		background: #1e293b;
		color: #fff;
		padding: 6px 12px;
		border-radius: 8px;
		font-size: 13px;
		font-weight: 500;
		white-space: nowrap;
		opacity: 0;
		visibility: hidden;
		transform: translateX(-8px);
		transition: all 0.2s ease;
		pointer-events: none;
	}

	.nav-item:hover .nav-label {
		opacity: 1;
		visibility: visible;
		transform: translateX(0);
	}

	.nav-item :global(svg) {
		transition: transform 0.3s ease;
	}

	.nav-item:hover {
		color: rgba(30, 41, 59, 0.7);
		background: rgba(30, 41, 59, 0.05);
	}

	.nav-item:hover :global(svg) {
		transform: scale(1.15);
	}

	.nav-item.active {
		color: #1e293b;
		background: #fff;
		border: 1px solid rgba(0, 0, 0, 0.05);
		box-shadow: 0 8px 32px rgba(0, 0, 0, 0.08);
	}

	.theme-toggle {
		display: flex;
		align-items: center;
		justify-content: center;
		width: 44px;
		height: 44px;
		border: none;
		background: transparent;
		color: rgba(30, 41, 59, 0.5);
		cursor: pointer;
		transition: all 0.3s ease;
		border-radius: 12px;
	}

	.theme-toggle:hover {
		color: rgba(30, 41, 59, 0.8);
	}

	/* Mobile responsive */
	@media (max-width: 768px) {
		.navbar {
			left: 20px;
			top: 20px;
			flex-direction: row;
		}

		.nav-links {
			flex-direction: row;
			padding: 4px;
			gap: 4px;
		}

		.nav-item {
			width: 40px;
			height: 40px;
		}

		.nav-label {
			display: none;
		}

		.theme-toggle {
			position: fixed;
			top: 20px;
			right: 20px;
			left: auto;
			width: 40px;
			height: 40px;
		}
	}
</style>

<script>
	// Active state based on scroll
	const navItems = document.querySelectorAll('.nav-item');

	const observerOptions = {
		root: null,
		rootMargin: '0px',
		threshold: 0.5
	};

	const observer = new IntersectionObserver((entries) => {
		entries.forEach(entry => {
			if (entry.isIntersecting) {
				const id = entry.target.id;
				navItems.forEach(item => {
					item.classList.remove('active');
					if (item.getAttribute('data-section') === id) {
						item.classList.add('active');
					}
				});
			}
		});
	}, observerOptions);

	// Observe sections when they exist
	document.querySelectorAll('section[id]').forEach(section => {
		observer.observe(section);
	});
</script>
